
有监督学习
======
案例：房价问题
-------


$x_1$ = size,$x_2$ = number of bedrooms<br> 
$h(x) = \theta_0 +\theta_1x_1+\theta_2x_2$<br>  
we can define $x_0=1$,that means<br>  
$h(x)=\sum_i=1^2{\theta_ix_i}=\theta^Tx$<br>  
if we have n features,it becomes<br>  
$h(x)=\sum_i=1^n{\theta_ix_i}=\theta^Tx$<br>  
<br>
损失函数：使得预测出来的值和真实值之间的平方差尽可能小(最小二乘法)<br>  
$J(\theta)=\frac{1}{2}\sum_{j=1}^{m}(h_{\theta}(x^{(i)})-y^{(i)})^2$<br>  
${min}_{\theta}J(\theta)$   

#算法一：梯度算法 
选择某个$\theta$的起始值，变化$\theta$，不断降低$J(\theta)$   
问题：局部最小化而非全局最小化
为什么不用矩阵乘法？ 
因为有可能矩阵不可逆  

如何检验收敛：两次梯度下降后的值不再变化（变化值小于一个很小的值）
<br>  

$\theta_i:=\theta_i-\alpha\frac{\partial}{\theta_i}J(\theta)$<br>
$\frac{\partial J(\theta)}{\partial\theta_i}=\sum_{j=1}^{m}(h(\theta)-y)*x_j^{(i)}$

#算法二：批梯度算法（随机梯度算法）
随机梯度下降<b>     
Repeat<b>   
$for\ j=1\ to\ m \lbrace$<br>  
    $\theta_i:=\theta_i-\alpha(h_\theta(x^{(j)})-y{(j)})*x_i^{(j)}$<b>  
    $rbrace$

#算法三：最小二乘法<br>
几个有用的矩阵迹的定理：
$tr AB = tr BA$<br>
$tr ABC = tr CAB = tr BCA$<br>
$\nabla_A{tr AB} = B^T$<br>
$tr A = tr A^T$<br>
$if\ a\in\ R,tra = a$<br>
$\nabla_A\ tr ABA^TC=CAB+C^TAB^T$


逻辑回归
---------

$y\in\{0,1\}$<br>
$h_\theta(x)\in[0,1]$<br>
choose:<br>
$h_\theta(x)=g(\theta^Tx)=\frac{1}{1+e^{-\theta^Tx}}$<br>
$g[z]=\frac{1}{1+e^{-z}}$


y值的概率可以写成<br>
$P(y|x;\theta)=h_\theta(x)^y(1-h_\theta(x)^{1-y})$

最大似然函数：<br>
$L(\theta) = \prod P(y|x;\theta)$
为简化计算，令$l(\theta)=log L(\theta)$，不改变单调性<br>
$l(\theta) = log \pord h_\theta(x)^y(1-h_\theta(x)^{1-y})$<br>
           $= \sum y^ilog(h(\theta))+(1-y^i)log(1-h(\theta))$<br>

计算可得,$\frac{\partial h(\theta)}{\partial \theta} = h(\theta)(1-h(\theta))$

$\frac{\partial l(\theta)}{\partial \theta} = \sum y^i(\frac{1}{h(\theta)})h(\theta)(1-h(\theta)x^i)+(y^i-1)\frac{1}{h(\theta-1)}h(\theta)(h(\theta)-1)x^i$<br>
                                $= \sum y^i(1-h(\theta))x^i+(y^i-1)h(\theta)x^i$<br>    
                                $= \sum y^ix^i-y^ih(\theta)x^i+y^ih(\theta)x^i-h(\theta)x^i$<br>    
                                $= \sum (y^i-h(\theta))x^i$ 




           
    



